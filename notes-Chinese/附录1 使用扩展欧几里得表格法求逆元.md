# 附录1 使用扩展欧几里得表格法求逆元

**使用扩展欧几里得表格算法，在$Z_N$中，求$a \in Z_N$的逆元$a^{-1}$。**

$x = a^{-1} (\bmod N) \iff x \times a \equiv 1(\bmod N) \iff xa+yN = 1$

| 余数$r$                       | 商$q$                                     | 生成元系数$x$                        | 模系数$y$                            |
| :---------------------------- | ----------------------------------------- | ------------------------------------ | ------------------------------------ |
| $r_{-1}=N$                    | -                                         | $x_{-1}=0$                           | $y_{-1}=1$                           |
| $r_0 =a$                      | -                                         | $x_{0}=1$                            | $y_{0}=0$                            |
| $r_i = r_{i-2} \bmod r_{i-1}$ | $q_i = \lfloor r_{i-2} / r_{i-1} \rfloor$ | $x_i = x_{i-2} - q_i \times x_{i-1}$ | $y_i = y_{i-2} - q_i \times y_{i-1}$ |
| ...                           | ...                                       | ...                                  | ...                                  |
| $1$                           | $q_t$                                     | $x_t$                                | $y_t$                                |

表中，$\lfloor c \rfloor$表示对$c$下取整。初始化时填写前两行，经过$t$次迭代，直至$r_t = 1$，得到最终解$x = x_t, y=y_t$，代入上式即得到$x_t$即为$x$的逆元。



例如，求$31 \in Z_{35}$的逆元$31^{-1}$。

$31x+35y = 1$，求解$x \in Z_{35}$。

| 余数$r$           | 商$q$                         | 生成元系数$x$            | 模系数$y$           |
| :---------------- | ----------------------------- | ------------------------ | ------------------- |
| $35$              | -                             | $0$                      | $1$                 |
| $31$              | -                             | $1$                      | $0$                 |
| $4 = 35 \bmod 31$ | $1 = \lfloor 35 / 31 \rfloor$ | $-1 = 0 - 1 \times 1$    | $1 = 1-0\times1$    |
| $3 = 31 \bmod 4$  | $7 = \lfloor 31 / 4 \rfloor$  | $8 = 1 - (-1) \times 7$  | $-7 = 0-1\times7$   |
| $1 = 4 \bmod 3$   | $1 = \lfloor 4 / 3 \rfloor$   | $-9 = (-1) - 8 \times 1$ | $8 = 1-(-7)\times1$ |

即：$31\times(-9)+35\times8 = 1$。因此，$31^{-1} = (-9) \bmod 35 = 26$。

